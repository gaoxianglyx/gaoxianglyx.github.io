<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>HTTP缓存笔记 | 高翔的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="网上笔记的摘抄，加上自己的理解">
<meta property="og:type" content="article">
<meta property="og:title" content="HTTP缓存笔记">
<meta property="og:url" content="http://yoursite.com/2017/02/25/HTTP缓存笔记/index.html">
<meta property="og:site_name" content="高翔的博客">
<meta property="og:description" content="网上笔记的摘抄，加上自己的理解">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/96ea1c33gy1fd2qzs3nwdj20gu0db74o">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/96ea1c33gy1fd2r1kj9xbj20jz0dpdhn">
<meta property="og:updated_time" content="2017-02-25T07:31:52.453Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HTTP缓存笔记">
<meta name="twitter:description" content="网上笔记的摘抄，加上自己的理解">
<meta name="twitter:image" content="http://ww1.sinaimg.cn/large/96ea1c33gy1fd2qzs3nwdj20gu0db74o">
  
    <link rel="alternate" href="/atom.xml" title="高翔的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">高翔的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-HTTP缓存笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/25/HTTP缓存笔记/" class="article-date">
  <time datetime="2017-02-25T07:21:10.026Z" itemprop="datePublished">2017-02-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/笔记/">笔记</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      HTTP缓存笔记
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>网上笔记的摘抄，加上自己的理解</strong><br><a id="more"></a></p>
<h1 id="HTTP缓存"><a href="#HTTP缓存" class="headerlink" title="HTTP缓存"></a>HTTP缓存</h1><h2 id="使用缓存有如下几个好处："><a href="#使用缓存有如下几个好处：" class="headerlink" title="使用缓存有如下几个好处："></a>使用缓存有如下几个好处：</h2><ul>
<li>缓存减少了冗余的数据传输， 节省了你的网络费用。 （将每次传送的相同的直接缓存起来）</li>
<li>缓存缓解了网络瓶颈的问题。 不需要更多的带宽就能够更快地加载页面。 （这是当然）</li>
<li>缓存降低了对原始服务器的要求。 服务器可以更快地响应，避免过载的出现。 </li>
<li>缓存降低了距离时延， 因为从较远的地方加载页面会更慢一些。</li>
</ul>
<h2 id="缓存分类"><a href="#缓存分类" class="headerlink" title="缓存分类"></a>缓存分类</h2><p>　　1）私有缓存<br>　　常见就是我们的浏览器里内置的缓存。</p>
<p>　　2）公有缓存<br>　　常见的就是代理缓存，不多介绍。
　　</p>
<h2 id="3-缓存的处理流程"><a href="#3-缓存的处理流程" class="headerlink" title="3.缓存的处理流程"></a>3.缓存的处理流程</h2><p><img src="http://ww1.sinaimg.cn/large/96ea1c33gy1fd2qzs3nwdj20gu0db74o" alt="image"></p>
<h3 id="处理流程图，如上所示，下面分步骤具体介绍："><a href="#处理流程图，如上所示，下面分步骤具体介绍：" class="headerlink" title="　　处理流程图，如上所示，下面分步骤具体介绍："></a>　　处理流程图，如上所示，下面分步骤具体介绍：</h3><h4 id="1）请求处理"><a href="#1）请求处理" class="headerlink" title="1）请求处理"></a>1）请求处理</h4><p>　　用户发起一个http请求，缓存获取到URL，根据URL查找是否有匹配的副本，这个副本可能在内存中，也可能在本地磁盘。  </p>
<h4 id="2）-新鲜度检测"><a href="#2）-新鲜度检测" class="headerlink" title="2） 新鲜度检测"></a>2） 新鲜度检测</h4><p>　　如果缓存中存在所请求资源的副本，则进行新鲜度检测。HTTP发起一个请求时，发现缓存中有相应的副本，接着就会检查这个副本有没有过期，如果没有过期，直接使用。如果已经过期，则进行再验证。具体的实现在下面会介绍。  </p>
<h4 id="3）服务器再验证"><a href="#3）服务器再验证" class="headerlink" title="3）服务器再验证"></a>3）服务器再验证</h4><p>　　缓存中的文档过期了并不代表他和服务器上的不一样，所以这个时候就需要问问服务器，过期的这段时间里这个文档到底有没有改变。如果改变了，缓存就会获取一份新的文档副本，然后发送给客户端。如果没有改变，缓存只需要获取新的首部，包括一个新的过期时间，并对缓存中的首部更新。</p>
<h4 id="4）创建响应并返回"><a href="#4）创建响应并返回" class="headerlink" title="　　4）创建响应并返回"></a>　　4）创建响应并返回</h4><p>　　我们希望缓存看起来就像是来自原始服务器一样，缓存将已缓存的服务器响应首部作为响应首部，发送给客户端。</p>
<h2 id="4-保质期的实现"><a href="#4-保质期的实现" class="headerlink" title="　　4.保质期的实现"></a>　　4.保质期的实现</h2><p>　　HTTP中，通过Cache-Control首部和Expires首部为文档指定了过期时间，通过对过期时间的判断，缓存就可以知道文档是不是在保质期内。Expires首部和Cache-Control:max-age首部都是来告诉缓存文档有没有过期，<br>　　HTTP 1.1为了修正这个问题，引入了Cache-Control:max-age首部，这个首部使用相对时间来控制保质期，让一切变得更加合理。</p>
<h2 id="5-服务器再验证的实现"><a href="#5-服务器再验证的实现" class="headerlink" title="　　5.服务器再验证的实现"></a>　　5.服务器再验证的实现</h2><p>　　缓存要问问服务器。HTTP中，使用两个请求请首部来完成这个功能：If-Modified-Sice和If-None-Match。为啥又要两个首部来完成这个功能了？答案还是因为历史的原因。一开始使用 If-Modified-Sice:<date>首部，date是上一次缓存牛奶时，响应中Last-Modified首部的值。<br>　　客户端拿着这个值，问服务器，这段时间内这个牛奶你有没有修改过？服务器看了看这个牛奶的修改时间，如果没有修改过，会返回一个304 Not Modified的响应；如果修改过，把最新的牛奶返回给客户端。后来，人们发现这样有问题，因为就算修改时间变化了，文档也不一定发生改变！于是乎，就有了 If-None-Match:<tag>首部，tag是上一次缓存文档时，响应中Etag的值，Etag是一种唯一标识资源的方式，就像java中的hashcode，如果hashcode不一样，那么两个对象肯定不一样！</tag></date></p>
<h2 id="6-试探性过期"><a href="#6-试探性过期" class="headerlink" title="　　6.试探性过期"></a>　　6.试探性过期</h2><p>　　如果响应中既没有Cache-Control:max-age首部又没有Expires首部，缓存可以计算出一个试探性最大使用期。这东西打个比方就是缓存会根据响应的Last-Modified来决定这文档靠不靠谱，需不需要再验证，如果Last-Modified中的日期是很早之前，那缓存就认为这文档挺靠谱，近期之内应该不会变化；如果Last-Modified中的日期是最近几天，那缓存可能就认为这文档可能经常改变，不靠谱。当然这么粗略的判断想想就知道不严谨，所以我们一定要设置Expires首部和Cache-Control首部。</p>
<ul>
<li>Expires:绝对过期时间，优先级低，快被淘汰了，因为根据服务器的时间会有差异</li>
<li>Cache-Control:相对过期时间</li>
<li>Last-Modified：最后更改时间，但是有些周期性更新，实际资源没有更改，所有引入Etag</li>
<li>Etag：标识版本，如果资源没有变化，就不会改变版本<h2 id="7-返回状态码说明"><a href="#7-返回状态码说明" class="headerlink" title="　　7.返回状态码说明"></a>　　7.返回状态码说明</h2><img src="http://ww1.sinaimg.cn/large/96ea1c33gy1fd2r1kj9xbj20jz0dpdhn" alt="image"></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/02/25/HTTP缓存笔记/" data-id="cj025nwxw00048ovld0m69nmh" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HTTP/">HTTP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/笔记/">笔记</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/缓存/">缓存</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/02/25/javascript继承的方式/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          javascript继承的方式
        
      </div>
    </a>
  
  
    <a href="/2017/02/21/HTML5的History Api/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">HTML5的History Api</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/插件/">插件</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/理解/">理解</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/笔记/">笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/面试/">面试</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gulp/">Gulp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML5/">HTML5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS/">JS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MVC/">MVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node/">Node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP/">TCP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/">Webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redux/">redux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/url/">url</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/体会/">体会</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端框架/">前端框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/区别/">区别</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/原型/">原型</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/参数/">参数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小恩爱/">小恩爱</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/扇贝/">扇贝</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/插件/">插件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/搭建博客/">搭建博客</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据类型/">数据类型</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/机制/">机制</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模式/">模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器/">浏览器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/理解/">理解</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/笔记/">笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/继承/">继承</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/缓存/">缓存</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/阿里巴巴/">阿里巴巴</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/面试题/">面试题</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Gulp/" style="font-size: 10px;">Gulp</a> <a href="/tags/HTML5/" style="font-size: 10px;">HTML5</a> <a href="/tags/HTTP/" style="font-size: 13.33px;">HTTP</a> <a href="/tags/JS/" style="font-size: 20px;">JS</a> <a href="/tags/MVC/" style="font-size: 10px;">MVC</a> <a href="/tags/Node/" style="font-size: 10px;">Node</a> <a href="/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/js/" style="font-size: 10px;">js</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/redux/" style="font-size: 10px;">redux</a> <a href="/tags/url/" style="font-size: 10px;">url</a> <a href="/tags/体会/" style="font-size: 13.33px;">体会</a> <a href="/tags/前端框架/" style="font-size: 10px;">前端框架</a> <a href="/tags/区别/" style="font-size: 10px;">区别</a> <a href="/tags/原型/" style="font-size: 10px;">原型</a> <a href="/tags/参数/" style="font-size: 10px;">参数</a> <a href="/tags/小恩爱/" style="font-size: 10px;">小恩爱</a> <a href="/tags/扇贝/" style="font-size: 10px;">扇贝</a> <a href="/tags/插件/" style="font-size: 10px;">插件</a> <a href="/tags/搭建博客/" style="font-size: 10px;">搭建博客</a> <a href="/tags/数据类型/" style="font-size: 10px;">数据类型</a> <a href="/tags/机制/" style="font-size: 10px;">机制</a> <a href="/tags/模式/" style="font-size: 10px;">模式</a> <a href="/tags/浏览器/" style="font-size: 10px;">浏览器</a> <a href="/tags/理解/" style="font-size: 10px;">理解</a> <a href="/tags/笔记/" style="font-size: 13.33px;">笔记</a> <a href="/tags/继承/" style="font-size: 10px;">继承</a> <a href="/tags/缓存/" style="font-size: 10px;">缓存</a> <a href="/tags/阿里巴巴/" style="font-size: 10px;">阿里巴巴</a> <a href="/tags/面试题/" style="font-size: 16.67px;">面试题</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/03/07/线程和进程的理解/">线程和进程的理解</a>
          </li>
        
          <li>
            <a href="/2017/03/05/Redux学习笔记/">初学redux笔记，及一个最简单的redux例子</a>
          </li>
        
          <li>
            <a href="/2017/03/05/三次握手和四次挥手简单笔记/">三次握手和四次挥手简单笔记</a>
          </li>
        
          <li>
            <a href="/2017/03/02/小恩爱视频面试心得/">小恩爱视频面试心得体会</a>
          </li>
        
          <li>
            <a href="/2017/02/27/扇贝面试题及体会/">扇贝面试题及体会</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 高翔<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>